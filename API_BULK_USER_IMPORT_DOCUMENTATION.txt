API –î–õ–Ø –ü–ê–ö–ï–¢–ù–û–ì–û –ò–ú–ü–û–†–¢–ê –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–ï–ô
=====================================

–û–ü–ò–°–ê–ù–ò–ï
--------
API –¥–ª—è –ø–∞–∫–µ—Ç–Ω–æ–≥–æ –∏–º–ø–æ—Ä—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ Excel —Ñ–∞–π–ª–æ–≤. –ü–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å —Ñ–∞–π–ª—ã —Å –¥–∞–Ω–Ω—ã–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π,
–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–≤–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç—ã, –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Ä–æ–ª–∏ –∏ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –∏—Ö –Ω–∞ email.

–û–°–û–ë–ï–ù–ù–û–°–¢–ò
-----------
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ–æ—Ä–º–∞—Ç–æ–≤ Excel (.xlsx, .xls)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–∞—Ä–æ–ª–µ–π
- –û—Ç–ø—Ä–∞–≤–∫–∞ –ø–∞—Ä–æ–ª–µ–π –Ω–∞ email
- –ü—Ä–∏–≤—è–∑–∫–∞ –∫ –≥—Ä—É–ø–ø–∞–º/–ø–æ–¥–≥—Ä—É–ø–ø–∞–º
- –ü–æ–¥—Ä–æ–±–Ω–∞—è –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç—å –æ–± –æ—à–∏–±–∫–∞—Ö

–§–û–†–ú–ê–¢ EXCEL –§–ê–ô–õ–ê
------------------
–§–∞–π–ª –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –∫–æ–ª–æ–Ω–∫–∏:

| –ö–æ–ª–æ–Ω–∫–∞ | –û–ø–∏—Å–∞–Ω–∏–µ | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è | –ü—Ä–∏–º–µ—Ä |
|---------|----------|--------------|--------|
| fio | –§–ò–û –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | –î–∞ | "–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á" |
| email | Email –∞–¥—Ä–µ—Å | –î–∞ | "ivanov@example.com" |
| phone | –ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ | –î–∞ | "+79012345678" –∏–ª–∏ "89012345678" |

–í–ê–õ–ò–î–ê–¶–ò–Ø –î–ê–ù–ù–´–•
----------------
- **–§–ò–û**: –î–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 2 —Å–ª–æ–≤–∞, –∫–∞–∂–¥–æ–µ —Å–ª–æ–≤–æ –º–∏–Ω–∏–º—É–º 2 —Å–∏–º–≤–æ–ª–∞
- **Email**: –î–æ–ª–∂–µ–Ω —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–º—É —Ñ–æ—Ä–º–∞—Ç—É email
- **–¢–µ–ª–µ—Ñ–æ–Ω**: –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è —Ñ–æ—Ä–º–∞—Ç—ã:
  - E164: +79012345678
  - –†–æ—Å—Å–∏–π—Å–∫–∏–π —Å 8: 89012345678
  - –†–æ—Å—Å–∏–π—Å–∫–∏–π —Å 7: 79012345678

ENDPOINTS
=========

1. POST /api/users/bulk-import - –ò–º–ø–æ—Ä—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ Excel —Ñ–∞–π–ª–∞
------------------------------------------------------------------

–û–ü–ò–°–ê–ù–ò–ï: –ó–∞–≥—Ä—É–∂–∞–µ—Ç Excel —Ñ–∞–π–ª –∏ —Å–æ–∑–¥–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ —Å–∏—Å—Ç–µ–º–µ

–ó–ê–ü–†–û–°:
- –ú–µ—Ç–æ–¥: POST
- URL: /api/users/bulk-import
- Content-Type: multipart/form-data

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ–æ—Ä–º—ã:
- file (file, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π) - Excel —Ñ–∞–π–ª —Å –¥–∞–Ω–Ω—ã–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- org_unit_id (int, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - ID –≥—Ä—É–ø–ø—ã –¥–ª—è –ø—Ä–∏–≤—è–∑–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

–û–¢–í–ï–¢:
- –°—Ç–∞—Ç—É—Å: 200 OK (—É—Å–ø–µ—Ö) –∏–ª–∏ 400 Bad Request (–æ—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏) –∏–ª–∏ 500 Internal Server Error
- Content-Type: application/json

–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞ (—É—Å–ø–µ—Ö):
{
  "success": true,
  "message": "–ò–º–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à–µ–Ω. –°–æ–∑–¥–∞–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: 5, –ø—Ä–æ–ø—É—â–µ–Ω–æ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö: 2, –æ—à–∏–±–æ–∫: 1",
  "created_users": [
    {
      "user_id": 123,
      "fio": "–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á",
      "email": "ivanov@example.com",
      "phone_e164": "+79012345678",
      "password": "Abc123Xy",
      "email_sent": true,
      "row_number": 2
    }
  ],
  "errors": [
    "–°—Ç—Ä–æ–∫–∞ 5: –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π email 'invalid-email'"
  ],
  "statistics": {
    "total_parsed": 8,
    "valid_users": 7,
    "existing_users": 2,
    "created_users": 5,
    "errors": 1
  }
}

–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞ (–æ—à–∏–±–∫–∞):
{
  "success": false,
  "message": "–ù–µ –Ω–∞–π–¥–µ–Ω–æ –≤–∞–ª–∏–¥–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞",
  "errors": [
    "–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏: fio, email",
    "–°—Ç—Ä–æ–∫–∞ 2: –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ç–µ–ª–µ—Ñ–æ–Ω '123'"
  ],
  "statistics": {
    "total_parsed": 0,
    "valid_users": 0,
    "existing_users": 0,
    "created_users": 0,
    "errors": 2
  }
}

–û–®–ò–ë–ö–ò:
- 400: "–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç —Ñ–∞–π–ª –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞"
- 400: "–ù–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π —Ñ–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞. –†–∞–∑—Ä–µ—à–µ–Ω—ã: .xlsx, .xls"
- 400: "–§–∞–π–ª —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π. –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä: 10MB"
- 400: "org_unit_id –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —á–∏—Å–ª–æ–º"

2. GET /api/users/bulk-import/template - –ü–æ–ª—É—á–∏—Ç—å —à–∞–±–ª–æ–Ω Excel —Ñ–∞–π–ª–∞
-------------------------------------------------------------------

–û–ü–ò–°–ê–ù–ò–ï: –°–∫–∞—á–∏–≤–∞–µ—Ç —à–∞–±–ª–æ–Ω Excel —Ñ–∞–π–ª–∞ —Å –ø—Ä–∏–º–µ—Ä–æ–º –¥–∞–Ω–Ω—ã—Ö

–ó–ê–ü–†–û–°:
- –ú–µ—Ç–æ–¥: GET
- URL: /api/users/bulk-import/template

–û–¢–í–ï–¢:
- –°—Ç–∞—Ç—É—Å: 200 OK
- Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet
- Content-Disposition: attachment; filename="users_import_template.xlsx"

–§–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç:
- –ó–∞–≥–æ–ª–æ–≤–∫–∏ –∫–æ–ª–æ–Ω–æ–∫: fio, email, phone
- –ü—Ä–∏–º–µ—Ä—ã –¥–∞–Ω–Ω—ã—Ö –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ
- –ü—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—É—é —à–∏—Ä–∏–Ω—É –∫–æ–ª–æ–Ω–æ–∫

3. POST /api/users/bulk-import/validate - –í–∞–ª–∏–¥–∞—Ü–∏—è Excel —Ñ–∞–π–ª–∞
--------------------------------------------------------------

–û–ü–ò–°–ê–ù–ò–ï: –ü—Ä–æ–≤–µ—Ä—è–µ—Ç Excel —Ñ–∞–π–ª –Ω–∞ –æ—à–∏–±–∫–∏ –±–µ–∑ —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

–ó–ê–ü–†–û–°:
- –ú–µ—Ç–æ–¥: POST
- URL: /api/users/bulk-import/validate
- Content-Type: multipart/form-data

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ–æ—Ä–º—ã:
- file (file, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π) - Excel —Ñ–∞–π–ª –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏

–û–¢–í–ï–¢:
- –°—Ç–∞—Ç—É—Å: 200 OK (—É—Å–ø–µ—Ö) –∏–ª–∏ 400 Bad Request (–æ—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏)
- Content-Type: application/json

–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞ (—É—Å–ø–µ—Ö):
{
  "success": true,
  "message": "–í–∞–ª–∏–¥–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞. –ù–∞–π–¥–µ–Ω–æ 5 –≤–∞–ª–∏–¥–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π",
  "errors": [],
  "statistics": {
    "total_rows": 5,
    "valid_users": 5,
    "new_users": 5,
    "existing_users": 0,
    "errors": 0
  },
  "preview_users": [
    {
      "fio": "–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á",
      "email": "ivanov@example.com",
      "phone_e164": "+79012345678",
      "row_number": 2
    }
  ]
}

–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞ (—Å –æ—à–∏–±–∫–∞–º–∏):
{
  "success": false,
  "message": "–í–∞–ª–∏–¥–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞. –ù–∞–π–¥–µ–Ω–æ 3 –≤–∞–ª–∏–¥–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, 2 —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç, 1 —Å –æ—à–∏–±–∫–∞–º–∏",
  "errors": [
    "–°—Ç—Ä–æ–∫–∞ 4: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–µ–ª–µ—Ñ–æ–Ω–æ–º +79012345678 —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç",
    "–°—Ç—Ä–æ–∫–∞ 6: –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π email 'invalid-email'"
  ],
  "statistics": {
    "total_rows": 6,
    "valid_users": 5,
    "new_users": 3,
    "existing_users": 2,
    "errors": 2
  },
  "preview_users": [
    {
      "fio": "–ü–µ—Ç—Ä–æ–≤ –ü–µ—Ç—Ä –ü–µ—Ç—Ä–æ–≤–∏—á",
      "email": "petrov@example.com",
      "phone_e164": "+79098765432",
      "row_number": 3
    }
  ]
}

–ü–†–ò–ú–ï–†–´ –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Ø –î–õ–Ø –§–†–û–ù–¢–ï–ù–î–ê
==================================

1. –°–∫–∞—á–∏–≤–∞–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞:
```javascript
const downloadTemplate = async () => {
  try {
    const response = await fetch('/api/users/bulk-import/template');
    
    if (response.ok) {
      const blob = await response.blob();
      const url = window.URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'users_import_template.xlsx';
      document.body.appendChild(a);
      a.click();
      window.URL.revokeObjectURL(url);
      document.body.removeChild(a);
    } else {
      console.error('–û—à–∏–±–∫–∞ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è —à–∞–±–ª–æ–Ω–∞');
    }
  } catch (error) {
    console.error('–û—à–∏–±–∫–∞:', error);
  }
};
```

2. –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–∞–π–ª–∞ –ø–µ—Ä–µ–¥ –∏–º–ø–æ—Ä—Ç–æ–º:
```javascript
const validateFile = async (file) => {
  const formData = new FormData();
  formData.append('file', file);
  
  try {
    const response = await fetch('/api/users/bulk-import/validate', {
      method: 'POST',
      body: formData
    });
    
    const result = await response.json();
    
    if (result.success) {
      console.log(`‚úÖ –§–∞–π–ª –≤–∞–ª–∏–¥–µ–Ω. –ù–∞–π–¥–µ–Ω–æ ${result.statistics.valid_users} –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π`);
      return true;
    } else {
      console.log(`‚ùå –û—à–∏–±–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏:`, result.errors);
      return false;
    }
  } catch (error) {
    console.error('–û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏:', error);
    return false;
  }
};
```

3. –ò–º–ø–æ—Ä—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:
```javascript
const importUsers = async (file, orgUnitId = null) => {
  const formData = new FormData();
  formData.append('file', file);
  
  if (orgUnitId) {
    formData.append('org_unit_id', orgUnitId);
  }
  
  try {
    const response = await fetch('/api/users/bulk-import', {
      method: 'POST',
      body: formData
    });
    
    const result = await response.json();
    
    if (result.success) {
      console.log(`‚úÖ –ò–º–ø–æ—Ä—Ç —É—Å–ø–µ—à–µ–Ω: ${result.message}`);
      console.log(`–°–æ–∑–¥–∞–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: ${result.statistics.created_users}`);
      
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
      result.created_users.forEach(user => {
        console.log(`- ${user.fio} (${user.email}) - –ø–∞—Ä–æ–ª—å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω: ${user.email_sent ? '–¥–∞' : '–Ω–µ—Ç'}`);
      });
      
      return result;
    } else {
      console.log(`‚ùå –û—à–∏–±–∫–∏ –∏–º–ø–æ—Ä—Ç–∞:`, result.errors);
      return result;
    }
  } catch (error) {
    console.error('–û—à–∏–±–∫–∞ –∏–º–ø–æ—Ä—Ç–∞:', error);
    return null;
  }
};
```

4. –ü–æ–ª–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å –∏–º–ø–æ—Ä—Ç–∞ —Å UI:
```javascript
const handleFileImport = async (file, orgUnitId) => {
  // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
  showLoadingIndicator();
  
  try {
    // 1. –í–∞–ª–∏–¥–∏—Ä—É–µ–º —Ñ–∞–π–ª
    const isValid = await validateFile(file);
    if (!isValid) {
      hideLoadingIndicator();
      showError('–§–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç –æ—à–∏–±–∫–∏. –ò—Å–ø—Ä–∞–≤—å—Ç–µ –∏—Ö –ø–µ—Ä–µ–¥ –∏–º–ø–æ—Ä—Ç–æ–º.');
      return;
    }
    
    // 2. –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
    const result = await importUsers(file, orgUnitId);
    
    hideLoadingIndicator();
    
    if (result && result.success) {
      showSuccess(`–ò–º–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à–µ–Ω! –°–æ–∑–¥–∞–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: ${result.statistics.created_users}`);
      
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–µ—Ç–∞–ª—å–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
      showImportResults(result);
    } else {
      showError('–û—à–∏–±–∫–∞ –∏–º–ø–æ—Ä—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π');
    }
    
  } catch (error) {
    hideLoadingIndicator();
    showError('–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ');
    console.error(error);
  }
};

const showImportResults = (result) => {
  const stats = result.statistics;
  
  const message = `
    üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏–º–ø–æ—Ä—Ç–∞:
    
    ‚úÖ –°–æ–∑–¥–∞–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: ${stats.created_users}
    ‚ö†Ô∏è –ü—Ä–æ–ø—É—â–µ–Ω–æ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö: ${stats.existing_users}
    ‚ùå –û—à–∏–±–æ–∫: ${stats.errors}
    
    ${result.errors.length > 0 ? `
    –û—à–∏–±–∫–∏:
    ${result.errors.map(error => `‚Ä¢ ${error}`).join('\n')}
    ` : ''}
  `;
  
  alert(message);
};
```

5. Drag & Drop –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞:
```html
<div id="file-drop-zone" class="drop-zone">
  <p>–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ Excel —Ñ–∞–π–ª —Å—é–¥–∞ –∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ –¥–ª—è –≤—ã–±–æ—Ä–∞</p>
  <input type="file" id="file-input" accept=".xlsx,.xls" style="display: none;">
</div>

<script>
const dropZone = document.getElementById('file-drop-zone');
const fileInput = document.getElementById('file-input');

dropZone.addEventListener('click', () => fileInput.click());
dropZone.addEventListener('dragover', (e) => {
  e.preventDefault();
  dropZone.classList.add('drag-over');
});

dropZone.addEventListener('dragleave', () => {
  dropZone.classList.remove('drag-over');
});

dropZone.addEventListener('drop', (e) => {
  e.preventDefault();
  dropZone.classList.remove('drag-over');
  
  const files = e.dataTransfer.files;
  if (files.length > 0) {
    const file = files[0];
    if (file.name.match(/\.(xlsx|xls)$/i)) {
      handleFileImport(file);
    } else {
      alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ Excel —Ñ–∞–π–ª (.xlsx –∏–ª–∏ .xls)');
    }
  }
});

fileInput.addEventListener('change', (e) => {
  const file = e.target.files[0];
  if (file) {
    handleFileImport(file);
  }
});
</script>
```

–û–ë–†–ê–ë–û–¢–ö–ê –û–®–ò–ë–û–ö
================

1. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–∞:
```javascript
const checkFileSize = (file) => {
  const maxSize = 10 * 1024 * 1024; // 10MB
  if (file.size > maxSize) {
    alert(`–§–∞–π–ª —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π. –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä: ${maxSize / (1024*1024)}MB`);
    return false;
  }
  return true;
};
```

2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–∞ —Ñ–∞–π–ª–∞:
```javascript
const checkFileType = (file) => {
  const allowedTypes = ['.xlsx', '.xls'];
  const fileExtension = file.name.toLowerCase().substring(file.name.lastIndexOf('.'));
  
  if (!allowedTypes.includes(fileExtension)) {
    alert(`–ù–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π —Ñ–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞. –†–∞–∑—Ä–µ—à–µ–Ω—ã: ${allowedTypes.join(', ')}`);
    return false;
  }
  return true;
};
```

3. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Å–µ—Ç–∏:
```javascript
const importWithRetry = async (file, orgUnitId, maxRetries = 3) => {
  for (let i = 0; i < maxRetries; i++) {
    try {
      const result = await importUsers(file, orgUnitId);
      return result;
    } catch (error) {
      if (i === maxRetries - 1) {
        throw error;
      }
      
      console.log(`–ü–æ–ø—ã—Ç–∫–∞ ${i + 1} –Ω–µ —É–¥–∞–ª–∞—Å—å, –ø–æ–≤—Ç–æ—Ä—è–µ–º —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã...`);
      await new Promise(resolve => setTimeout(resolve, 2000));
    }
  }
};
```

–í–ê–ñ–ù–´–ï –ó–ê–ú–ï–ß–ê–ù–ò–Ø
================

1. **–†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞**: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω 10MB –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

2. **–§–æ—Ä–º–∞—Ç —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤**: –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç —Ä–æ—Å—Å–∏–π—Å–∫–∏–µ –Ω–æ–º–µ—Ä–∞ –≤ —Ñ–æ—Ä–º–∞—Ç E164.

3. **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ**: –°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É –∏ email.

4. **Email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è**: –ü–∞—Ä–æ–ª–∏ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω—ã–µ email –∞–¥—Ä–µ—Å–∞.

5. **–ì—Ä—É–ø–ø—ã**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –±—ã—Ç—å –ø—Ä–∏–≤—è–∑–∞–Ω—ã –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –≥—Ä—É–ø–ø–µ –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ.

6. **–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏**: –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è—Ö –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö.

7. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –∏–º–ø–æ—Ä—Ç–∞ –ø–æ–¥—Ä–æ–±–Ω–æ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –¥–ª—è –∞—É–¥–∏—Ç–∞.

8. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: –î–ª—è –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –ø–µ—Ä–µ–¥ –∏–º–ø–æ—Ä—Ç–æ–º.

–ü–†–ò–ú–ï–† EXCEL –§–ê–ô–õ–ê
==================

| fio | email | phone |
|-----|-------|-------|
| –ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á | ivanov@example.com | +79012345678 |
| –ü–µ—Ç—Ä–æ–≤–∞ –ú–∞—Ä–∏—è –°–µ—Ä–≥–µ–µ–≤–Ω–∞ | petrova@example.com | 89098765432 |
| –°–∏–¥–æ—Ä–æ–≤ –ê–ª–µ–∫—Å–µ–π –í–ª–∞–¥–∏–º–∏—Ä–æ–≤–∏—á | sidorov@example.com | 79055555555 |

–ü—Ä–∏–º–µ—á–∞–Ω–∏—è:
- –¢–µ–ª–µ—Ñ–æ–Ω—ã –º–æ–≥—É—Ç –±—ã—Ç—å –≤ –ª—é–±–æ–º –∏–∑ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤
- –§–ò–û –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 2 —Å–ª–æ–≤–∞
- Email –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤–∞–ª–∏–¥–Ω—ã–º
- –ü—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏ –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è
